!function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return i(n?n:e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){e("./view/view3d"),$(function(){var t=window.twitterNodes||{};t.View3d=e("./view/view3d"),window.twitterNodes=t,window.init&&_.isFunction(window.init)&&window.init()})},{"./view/view3d":7}],2:[function(e,t,n){(new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),new THREE.MeshPhongMaterial({color:2827056,specular:11642818,shininess:90,shading:THREE.VertexColors,fog:!1});t.exports={getSphere:function(){var e=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:40,shading:THREE.VertexColors}),t=new THREE.SphereGeometry(32,32,32);return new THREE.Mesh(t,e)},getCylinder:function(e,t){var n=(new THREE.Vector3).subVectors(t,e),o=new THREE.Matrix4,i=new THREE.MeshPhongMaterial({color:2827056,specular:11642818,shininess:90,shading:THREE.VertexColors,transparent:!0});o.lookAt(e,t,(new THREE.Object3D).up),o.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1));var r=new THREE.CylinderGeometry(3,3,n.length(),16,1),a=new THREE.Mesh(r,i);return a.applyMatrix(o),a.position.x=(t.x+e.x)/2,a.position.y=(t.y+e.y)/2,a.position.z=(t.z+e.z)/2,a},getCube:function(){var e=new THREE.BoxGeometry(1,1,1),t=new THREE.MeshBasicMaterial({color:65280});return new THREE.Mesh(e,t)}}},{}],3:[function(e,t,n){var o=e("../util/request");t.exports={getTweets:function(e,t){o("GET","http://localhost:3001/twitter/"+e,{dataType:"json"},function(e,n){return e?t(e,null):void t(null,n.statuses)})}}},{"../util/request":6}],4:[function(e,t,n){var o={rgbToHex:function(e){var t,n,i,r,a=/^rgb\(\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*\)$/,s="";return(t=a.exec(e))&&(n=o.componentFromStr(t[1],t[2]),i=o.componentFromStr(t[3],t[4]),r=o.componentFromStr(t[5],t[6]),s="0x"+(16777216+(n<<16)+(i<<8)+r).toString(16).slice(1)),s},componentFromStr:function(e,t){var n=Math.max(0,parseInt(e,10));return t?Math.floor(255*Math.min(100,n)/100):Math.min(255,n)}};t.exports=o},{}],5:[function(e,t,n){t.exports=function(e,t,n){if(!(this instanceof arguments.callee))throw new Error("Constructor called as a function.");if(!t)throw new Error("Missing required parameter time.");if(!e)throw new Error("Missing required parameter callback.");var e=e,t=t,n=n||window,o=!1,i=function(){e&&(e.call(n),e=null),o=!0},r=setTimeout(i,t);this.cancel=function(){r&&!o&&(clearTimeout(r),r=null,e=null)}}},{}],6:[function(e,t,n){t.exports=function(e,t,n,o){if(_.isEmpty(e))throw new Error("request.js: Missing arg method");if(_.isEmpty(t))throw new Error("request.js: Missing arg url");if(!_.isString(t))throw new Error("request.js: String expected for url");if(!n)throw new Error("request.js: Missing arg data");if(!_.isObject(n))throw new Error("request.js: Object expected for data");if(!o)throw new Error("request.js: Missing arg callback");if(!_.isFunction(o))throw new Error("request.js: Function expected for callback");var i={url:t,type:e,data:n,dataType:"text",success:function(e,t,n){return o(null,JSON.parse(e))},error:function(e){return o(e.message,null)}};$.ajax(i)}},{}],7:[function(e,t,n){var o=e("../widgets/node3d"),i=e("../widgets/audio");t.exports=function(){var e=new i(function(){new o(e)})}},{"../widgets/audio":8,"../widgets/node3d":9}],8:[function(e,t,n){t.exports=function(e){var t,n,o,i,r,a,s,u,c=window.innerWidth,l=window.innerHeight,d={v:0,x:0},w=document.querySelector("#audio"),f=w.getContext("2d"),p=!1;this.getData=function(){return d};var h=function(){return(t=new(window.AudioContext||window.webkitAudioContext))?void g(function(n,o){if(n)throw n;s=o,i=t.createAnalyser(),i.minDecibels=-90,i.maxDecibels=-10,i.smoothingTimeConstant=.85,i.fftSize=2048,a=i.fftSize,r=new Uint8Array(a),o.connect(t.destination),o.connect(i),e&&e()}):console.warn("WebAudio API not supported")};this.start=function(){p||(p=!0,window.addEventListener("resize",E,!1),E(),v(),s.start())};var E=function(){c=window.innerWidth,l=window.innerHeight,w.width=c,w.height=l,u=f.createLinearGradient(0,l/2,0,l),u.addColorStop(0,"rgba(255, 255, 255, 1)"),u.addColorStop(1,"rgba(255, 255, 255, 0)")},g=function(e){var i=new XMLHttpRequest;i.open("GET","/audio/todd-terje-delorean-dynamite.ogg",!0),i.responseType="arraybuffer",i.onload=function(){t.decodeAudioData(i.response,function(i){o=i,n=t.createBufferSource(),n.loop=!0,n.buffer=o,e(null,n)},function(t){e("Error with decoding audio data"+t.err,null)})},i.send()},v=function(){requestAnimationFrame(v),T()},m=function(){var e,t=c/a*5.5,n=0;f.clearRect(0,0,c,l);for(var o=0;a>o;o++)e=5*r[o],f.fillStyle=u,f.fillRect(n,l-e/2,t,e/2),n+=t},T=function(){i.getByteFrequencyData(r),m()};h()}},{}],9:[function(e,t,n){var o=e("../model/tweetModel"),i=e("../model/3dObjectFactory"),r=e("../util/delayCall"),a=e("../util/color");t.exports=function(e){function t(){var e=new THREE.RenderPass(c,u),t=new THREE.BokehPass(c,u,{focus:.8,aperture:.015,maxblur:1});t.renderToScreen=!0;var n=new THREE.WebGLRenderTarget(T,x,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),o=new THREE.EffectComposer(l,n);o.addPass(e),o.addPass(t),H.composer=o,H.bokeh=t}var n,s,u,c,l,d,w,f,p,h,E,g=450,v={value:16777215},m=[],T=window.innerWidth,x=window.innerHeight,y=new THREE.Clock,H={},M=!0,R={x:0,y:0},b=function(){C(),$("#go").click(z),$(document).keypress(function(e){13==e.which&&z()})},C=function(){var e=document.querySelector("#webgl");u=new THREE.PerspectiveCamera(60,T/x,1,2500),u.position.z=2e3,d=new THREE.Vector3,c=new THREE.Scene,c.fog=new THREE.FogExp2(3355443,.002);var o=new THREE.DirectionalLight(16777215,1);o.position.set(1,1,1),c.add(o);var i=new THREE.DirectionalLight(34248,1);i.position.set(-1,-1,-1),c.add(i);var r=new THREE.AmbientLight(16777215);r.position.set(-1,-1,-1),c.add(r);var a=new THREE.SpotLight(34248,1);a.position.set(-1,-1,-1),c.add(a),s=new THREE.Object3D,h=new THREE.Object3D,n=new THREE.Object3D,c.add(s),s.add(h),s.add(n),l=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),l.setPixelRatio(window.devicePixelRatio),l.setClearColor(c.fog.color,0),l.setSize(window.innerWidth,window.innerHeight),M&&t(),e.appendChild(l.domElement),window.addEventListener("resize",L,!1),L(),k()},S=function(e){I(h),E&&(clearInterval(E),E=null),$(".loader").removeClass("hidden"),o.getTweets(e,function(e,t){if(e)throw e;return d.set(0,0,0),t.length?q(t):void alert("Oy homes! We got no tweets for ya!")})},O=function(e){if(!e)throw new Error("Missing len");console.log("generatePositions: "+e);var t=[],n=e,o=0,i=.3,r=0,a=function(){var e=new THREE.Vector3;return e.set(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1),e},s=function(e){for(var n=!1,o=0;o<t.length;o++){var r=e.distanceTo(t[o]);if(i>r){n=!0;break}}return n};do{var u=a();s(u)?r++:(t.push(u),o++)}while(n>o);return console.log("numReCalcs: "+r),t},q=function(t){var o=O(t.length);w&&w.dispose(),m=[],w=new THREE.Geometry;var a=0;_.each(t,function(e){var t=i.getSphere();t.position.set(o[a].x,o[a].y,o[a].z),t.position.normalize(),t.position.multiplyScalar(10*Math.random()+g),t.userData.tweet=e,m.push(t),w.vertices.push(t.position),h.add(t),a++});for(var s=0;s<w.vertices.length;s++){var u=w.vertices[s],c=w.vertices[s+1];c&&n.add(i.getCylinder(u,c))}f=0,p=null,$(".loader").addClass("hidden"),e.start(),new r(function(){j(F)},3500)},z=function(){var e=$('input[name="hashtag"]').val();e=String(e).trim(),e&&e.length&&($('input[name="hashtag"]').val(""),S(e))},j=function(e){var t=3.5;TweenMax.to(s.rotation,2*t,{y:720*(Math.PI/180),yoyo:!1,repeat:0,ease:Sine.easeInOut,onComplete:function(){e()}}),TweenMax.to(u.position,t,{z:800,yoyo:!0,repeat:1,ease:Sine.easeInOut})},F=function(){TweenMax.to(u.position,2,{z:1e3,ease:Cubic.easeInOut,onComplete:function(){P()}}),TweenMax.to(R,5,{x:25,yoyo:!0,repeat:-1,ease:Sine.easeInOut}),TweenMax.to(R,8,{y:25,yoyo:!0,repeat:-1,ease:Sine.easeInOut})},I=function(e){if(e)for(var t=e.children.length-1;t>=0;t--)e.remove(e.children[t])},P=function(){f==w.vertices.length&&(f=0),p=m[f++],TweenMax.to(v,3,{colorProps:{value:16738740},ease:Cubic.easeInOut,onUpdate:function(){p.material.color.setHex(a.rgbToHex(v.value))}}),TweenMax.to(d,2,{x:p.position.x,y:p.position.y,z:p.position.z,ease:Cubic.easeInOut}),TweenMax.to(u.position,2,{z:2e3,ease:Cubic.easeInOut}),TweenMax.to(u,2,{fov:1,delay:2,ease:Cubic.easeOut,onUpdate:D}),TweenMax.to(u.position,2,{delay:1,z:p.position.z,ease:Cubic.easeInOut,onComplete:function(){n.visible=!1,A(p.userData.tweet.text),E=setInterval(function(){clearInterval(E),E=null,TweenMax.to(".tweet",1,{css:{opacity:0},ease:Cubic.easeOut}),TweenMax.to(v,2,{delay:1,colorProps:{value:16777215},ease:Cubic.easeInOut,onUpdate:function(){p.material.color.setHex(a.rgbToHex(v.value))}}),n.visible=!0,TweenMax.to(u,2,{fov:60,delay:0,ease:Cubic.easeInOut,onUpdate:D,onComplete:function(){TweenMax.to(u.position,4,{delay:1.5,z:1e3,onComplete:function(){P()}})}})},4e3)}})},D=function(){u.updateProjectionMatrix()},A=function(e){$(".tweet").html(e),TweenMax.to(".tweet",1,{css:{opacity:1},ease:Cubic.easeOut})},L=function(){T=window.innerWidth,x=window.innerHeight,u.aspect=T/x,u.updateProjectionMatrix(),l.setSize(T,x),M&&H.composer.setSize(T,x),W()},k=function(){requestAnimationFrame(k),W()},W=function(){u.lookAt(d),u.position.x=R.x,u.position.y=R.y,l.render(c,u),M&&H.composer.render(y.getDelta())};window.innerWidth||(window.innerWidth=parent.innerWidth,window.innerHeight=parent.innerHeight),b()}},{"../model/3dObjectFactory":2,"../model/tweetModel":3,"../util/color":4,"../util/delayCall":5}]},{},[1]);