!function e(n,t,o){function i(a,s){if(!t[a]){if(!n[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=t[a]={exports:{}};n[a][0].call(l.exports,function(e){var t=n[a][1][e];return i(t?t:e)},l,l.exports,e,n,t,o)}return t[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,n,t){e("./view/view3d"),$(function(){var n=window.twitterNodes||{};n.View3d=e("./view/view3d"),window.twitterNodes=n,window.init&&_.isFunction(window.init)&&window.init()})},{"./view/view3d":6}],2:[function(e,n,t){(new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),new THREE.MeshPhongMaterial({color:2827056,specular:11642818,shininess:90,shading:THREE.VertexColors,fog:!1});n.exports={getSphere:function(){var e=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:40,shading:THREE.VertexColors}),n=new THREE.SphereGeometry(32,32,32);return new THREE.Mesh(n,e)},getCylinder:function(e,n){var t=(new THREE.Vector3).subVectors(n,e),o=new THREE.Matrix4,i=new THREE.MeshPhongMaterial({color:2827056,specular:11642818,shininess:90,shading:THREE.VertexColors,transparent:!0});o.lookAt(e,n,(new THREE.Object3D).up),o.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1));var r=new THREE.CylinderGeometry(3,3,t.length(),16,1),a=new THREE.Mesh(r,i);return a.applyMatrix(o),a.position.x=(n.x+e.x)/2,a.position.y=(n.y+e.y)/2,a.position.z=(n.z+e.z)/2,a},getCube:function(){var e=new THREE.BoxGeometry(1,1,1),n=new THREE.MeshBasicMaterial({color:65280});return new THREE.Mesh(e,n)}}},{}],3:[function(e,n,t){var o=e("../util/request");n.exports={getTweets:function(e){o("GET","http://localhost:3001/data/tweets",{dataType:"json"},function(n,t){return n?e(n,null):void e(null,t.statuses)})}}},{"../util/request":5}],4:[function(e,n,t){n.exports=function(e,n,t){if(!(this instanceof arguments.callee))throw new Error("Constructor called as a function.");if(!n)throw new Error("Missing required parameter time.");if(!e)throw new Error("Missing required parameter callback.");var e=e,n=n,t=t||window,o=!1,i=function(){e&&(e.call(t),e=null),o=!0},r=setTimeout(i,n);this.cancel=function(){r&&!o&&(clearTimeout(r),r=null,e=null)}}},{}],5:[function(e,n,t){n.exports=function(e,n,t,o){if(_.isEmpty(e))throw new Error("request.js: Missing arg method");if(_.isEmpty(n))throw new Error("request.js: Missing arg url");if(!_.isString(n))throw new Error("request.js: String expected for url");if(!t)throw new Error("request.js: Missing arg data");if(!_.isObject(t))throw new Error("request.js: Object expected for data");if(!o)throw new Error("request.js: Missing arg callback");if(!_.isFunction(o))throw new Error("request.js: Function expected for callback");var i={url:n,type:e,data:t,dataType:"text",success:function(e,n,t){return o(null,JSON.parse(e))},error:function(e){return o(e.message,null)}};$.ajax(i)}},{}],6:[function(e,n,t){var o=e("../widgets/node3d"),i=e("../widgets/audio");n.exports=function(){var e=new i(function(){new o(e)})}},{"../widgets/audio":7,"../widgets/node3d":8}],7:[function(e,n,t){n.exports=function(e){var n,t,o,i,r,a,s,u,c=window.innerWidth,l=window.innerHeight,d={v:0,x:0},w=document.querySelector("#audio"),f=w.getContext("2d");this.getData=function(){return d};var p=function(){return(n=new(window.AudioContext||window.webkitAudioContext))?void h(function(t,o){if(t)throw t;s=o,i=n.createAnalyser(),i.minDecibels=-90,i.maxDecibels=-10,i.smoothingTimeConstant=.85,i.fftSize=2048,a=i.fftSize,r=new Uint8Array(a),o.connect(n.destination),o.connect(i),e&&e()}):console.warn("WebAudio API not supported")};this.start=function(){window.addEventListener("resize",E,!1),E(),g(),s.start()};var E=function(){c=window.innerWidth,l=window.innerHeight,w.width=c,w.height=l,u=f.createLinearGradient(0,l/2,0,l),u.addColorStop(0,"rgba(255, 255, 255, 0.5)"),u.addColorStop(1,"rgba(255, 255, 255, 0)")},h=function(e){var i=new XMLHttpRequest;i.open("GET","/audio/todd-terje-delorean-dynamite.ogg",!0),i.responseType="arraybuffer",i.onload=function(){n.decodeAudioData(i.response,function(i){o=i,t=n.createBufferSource(),t.buffer=o,e(null,t)},function(n){e("Error with decoding audio data"+n.err,null)})},i.send()},g=function(){requestAnimationFrame(g),T()},v=function(){var e,n=c/a*5.5,t=0;f.clearRect(0,0,c,l);for(var o=0;a>o;o++)e=4*r[o],f.fillStyle=u,f.fillRect(t,l-e/2,n,e/2),t+=n+0},T=function(){i.getByteFrequencyData(r),v()};p()}},{}],8:[function(e,n,t){var o=e("../model/tweetModel"),i=e("../model/3dObjectFactory"),r=e("../util/delayCall");n.exports=function(e){function n(){var e=new THREE.RenderPass(u,s),n=new THREE.BokehPass(u,s,{focus:.8,aperture:.015,maxblur:1});n.renderToScreen=!0;var t=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),o=new THREE.EffectComposer(c,t);o.addPass(e),o.addPass(n),m.composer=o,m.bokeh=n}var t,a,s,u,c,l,d,w,f,p,E,h=450,g=[],v=window.innerWidth,T=window.innerHeight,x=new THREE.Clock,m={},y=!0,H={x:0,y:0},R=function(){M(),b()},M=function(){var e=document.querySelector("#webgl");s=new THREE.PerspectiveCamera(60,v/T,1,2e3),s.position.z=2e3,l=new THREE.Vector3,u=new THREE.Scene,u.fog=new THREE.FogExp2(3355443,.002);var o=new THREE.DirectionalLight(16777215,1);o.position.set(1,1,1),u.add(o);var i=new THREE.DirectionalLight(34248,1);i.position.set(-1,-1,-1),u.add(i);var r=new THREE.AmbientLight(16777215);r.position.set(-1,-1,-1),u.add(r);var d=new THREE.SpotLight(34248,1);d.position.set(-1,-1,-1),u.add(d),a=new THREE.Object3D,p=new THREE.Object3D,t=new THREE.Object3D,u.add(a),a.add(p),a.add(t),c=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),c.setPixelRatio(window.devicePixelRatio),c.setClearColor(u.fog.color,0),c.setSize(window.innerWidth,window.innerHeight),y&&n(),e.appendChild(c.domElement),window.addEventListener("resize",I,!1),I(),P()},b=function(){q(p),E&&(clearInterval(E),E=null),o.getTweets(function(e,n){if(e)throw e;return l.set(0,0,0),n.length?S(n):void console.log("Oy homes, we got no tweets for ya!")})},C=function(e){if(!e)throw new Error("Missing len");console.log("generatePositions: "+e);var n=[],t=e,o=0,i=.3,r=0,a=function(){var e=new THREE.Vector3;return e.set(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1),e},s=function(e){for(var t=!1,o=0;o<n.length;o++){var r=e.distanceTo(n[o]);if(i>r){t=!0;break}}return t};do{var u=a();s(u)?r++:(n.push(u),o++)}while(t>o);return console.log("numReCalcs: "+r),n},S=function(n){var o=C(n.length);d&&d.dispose(),g=[],d=new THREE.Geometry;var a=0;_.each(n,function(e){var n=i.getSphere();n.position.set(o[a].x,o[a].y,o[a].z),n.position.normalize(),n.position.multiplyScalar(10*Math.random()+h),n.userData.tweet=e,g.push(n),d.vertices.push(n.position),p.add(n),a++});for(var s=0;s<d.vertices.length;s++){var u=d.vertices[s],c=d.vertices[s+1];c&&t.add(i.getCylinder(u,c))}w=0,f=null,e.start(),new r(function(){O(j)},3500),$(".loader").addClass("hidden")},O=function(e){var n=3.5;TweenMax.to(a.rotation,2*n,{y:720*(Math.PI/180),yoyo:!1,repeat:0,ease:Sine.easeInOut,onComplete:function(){e()}}),console.log(s.position.z),TweenMax.to(s.position,n,{z:800,yoyo:!0,repeat:1,ease:Sine.easeInOut})},j=function(){TweenMax.to(s.position,2,{z:1e3,ease:Cubic.easeInOut,onComplete:function(){z()}}),TweenMax.to(H,5,{x:25,yoyo:!0,repeat:-1,ease:Sine.easeInOut}),TweenMax.to(H,8,{y:25,yoyo:!0,repeat:-1,ease:Sine.easeInOut})},q=function(e){if(e)for(var n=e.children.length-1;n>=0;n--)e.remove(e.children[n])},z=function(){w==d.vertices.length&&(w=0),f=g[w++],f.material.color.setHex(16738740),TweenMax.to(l,2,{x:f.position.x,y:f.position.y,z:f.position.z,ease:Cubic.easeInOut}),TweenMax.to(s.position,2,{z:1e3,ease:Cubic.easeInOut}),TweenMax.to(s,2,{fov:60,ease:Cubic.easeInOut,onUpdate:function(){s.updateProjectionMatrix()}}),TweenMax.to(s,2,{fov:1,delay:2,ease:Cubic.easeInOut,onUpdate:function(){s.updateProjectionMatrix()}}),TweenMax.to(t,2,{alpha:0,delay:2,ease:Cubic.easeInOut,onUpdate:function(){}}),TweenMax.to(s.position,2,{delay:2,z:f.position.z,ease:Cubic.easeInOut,onComplete:function(){D(f.userData.tweet.text),E=setInterval(function(){clearInterval(E),E=null,f.material.color.setHex(16777215),z()},3e3)}})},D=function(e){console.log(e);var n=$(".tweet");n.typed({strings:[e],typeSpeed:2,loop:!1,contentType:"text",showCursor:!1,loopCount:!1,callback:function(){console.log("callback")},resetCallback:function(){console.log("resetCallback")}})},I=function(){v=window.innerWidth,T=window.innerHeight,s.aspect=v/T,s.updateProjectionMatrix(),c.setSize(v,T),y&&m.composer.setSize(v,T),F()},P=function(){requestAnimationFrame(P),F()},F=function(){s.lookAt(l),s.position.x=H.x,s.position.y=H.y,c.render(u,s),y&&m.composer.render(x.getDelta())};window.innerWidth||(window.innerWidth=parent.innerWidth,window.innerHeight=parent.innerHeight),R()}},{"../model/3dObjectFactory":2,"../model/tweetModel":3,"../util/delayCall":4}]},{},[1]);