!function e(n,t,o){function r(a,s){if(!t[a]){if(!n[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=t[a]={exports:{}};n[a][0].call(l.exports,function(e){var t=n[a][1][e];return r(t?t:e)},l,l.exports,e,n,t,o)}return t[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,n,t){e("./view/view3d"),$(function(){var n=window.twitterNodes||{};n.View3d=e("./view/view3d"),window.twitterNodes=n,window.init&&_.isFunction(window.init)&&window.init()})},{"./view/view3d":7}],2:[function(e,n,t){(new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),new THREE.MeshPhongMaterial({color:2827056,specular:11642818,shininess:90,shading:THREE.VertexColors,fog:!1});n.exports={getSphere:function(){var e=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:40,shading:THREE.VertexColors}),n=new THREE.SphereGeometry(32,32,32);return new THREE.Mesh(n,e)},getCylinder:function(e,n){var t=(new THREE.Vector3).subVectors(n,e),o=new THREE.Matrix4,r=new THREE.MeshPhongMaterial({color:2827056,specular:11642818,shininess:90,shading:THREE.VertexColors,transparent:!0});o.lookAt(e,n,(new THREE.Object3D).up),o.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1));var i=new THREE.CylinderGeometry(3,3,t.length(),16,1),a=new THREE.Mesh(i,r);return a.applyMatrix(o),a.position.x=(n.x+e.x)/2,a.position.y=(n.y+e.y)/2,a.position.z=(n.z+e.z)/2,a},getCube:function(){var e=new THREE.BoxGeometry(1,1,1),n=new THREE.MeshBasicMaterial({color:65280});return new THREE.Mesh(e,n)}}},{}],3:[function(e,n,t){var o=e("../util/request");n.exports={getTweets:function(e){o("GET","http://localhost:3001/data/tweets",{dataType:"json"},function(n,t){return n?e(n,null):void e(null,t.statuses)})}}},{"../util/request":6}],4:[function(e,n,t){var o={rgbToHex:function(e){var n,t,r,i,a=/^rgb\(\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*\)$/,s="";return(n=a.exec(e))&&(t=o.componentFromStr(n[1],n[2]),r=o.componentFromStr(n[3],n[4]),i=o.componentFromStr(n[5],n[6]),s="0x"+(16777216+(t<<16)+(r<<8)+i).toString(16).slice(1)),s},componentFromStr:function(e,n){var t=Math.max(0,parseInt(e,10));return n?Math.floor(255*Math.min(100,t)/100):Math.min(255,t)}};n.exports=o},{}],5:[function(e,n,t){n.exports=function(e,n,t){if(!(this instanceof arguments.callee))throw new Error("Constructor called as a function.");if(!n)throw new Error("Missing required parameter time.");if(!e)throw new Error("Missing required parameter callback.");var e=e,n=n,t=t||window,o=!1,r=function(){e&&(e.call(t),e=null),o=!0},i=setTimeout(r,n);this.cancel=function(){i&&!o&&(clearTimeout(i),i=null,e=null)}}},{}],6:[function(e,n,t){n.exports=function(e,n,t,o){if(_.isEmpty(e))throw new Error("request.js: Missing arg method");if(_.isEmpty(n))throw new Error("request.js: Missing arg url");if(!_.isString(n))throw new Error("request.js: String expected for url");if(!t)throw new Error("request.js: Missing arg data");if(!_.isObject(t))throw new Error("request.js: Object expected for data");if(!o)throw new Error("request.js: Missing arg callback");if(!_.isFunction(o))throw new Error("request.js: Function expected for callback");var r={url:n,type:e,data:t,dataType:"text",success:function(e,n,t){return o(null,JSON.parse(e))},error:function(e){return o(e.message,null)}};$.ajax(r)}},{}],7:[function(e,n,t){var o=e("../widgets/node3d"),r=e("../widgets/audio");n.exports=function(){var e=new r(function(){new o(e)})}},{"../widgets/audio":8,"../widgets/node3d":9}],8:[function(e,n,t){n.exports=function(e){var n,t,o,r,i,a,s,u,c=window.innerWidth,l=window.innerHeight,d={v:0,x:0},w=document.querySelector("#audio"),f=w.getContext("2d");this.getData=function(){return d};var p=function(){return(n=new(window.AudioContext||window.webkitAudioContext))?void h(function(t,o){if(t)throw t;s=o,r=n.createAnalyser(),r.minDecibels=-90,r.maxDecibels=-10,r.smoothingTimeConstant=.85,r.fftSize=2048,a=r.fftSize,i=new Uint8Array(a),o.connect(n.destination),o.connect(r),e&&e()}):console.warn("WebAudio API not supported")};this.start=function(){window.addEventListener("resize",E,!1),E(),g(),s.start()};var E=function(){c=window.innerWidth,l=window.innerHeight,w.width=c,w.height=l,u=f.createLinearGradient(0,l/2,0,l),u.addColorStop(0,"rgba(255, 255, 255, 1)"),u.addColorStop(1,"rgba(255, 255, 255, 0)")},h=function(e){var r=new XMLHttpRequest;r.open("GET","/audio/todd-terje-delorean-dynamite.ogg",!0),r.responseType="arraybuffer",r.onload=function(){n.decodeAudioData(r.response,function(r){o=r,t=n.createBufferSource(),t.buffer=o,e(null,t)},function(n){e("Error with decoding audio data"+n.err,null)})},r.send()},g=function(){requestAnimationFrame(g),m()},v=function(){var e,n=c/a*5.5,t=0;f.clearRect(0,0,c,l);for(var o=0;a>o;o++)e=5*i[o],f.fillStyle=u,f.fillRect(t,l-e/2,n,e/2),t+=n},m=function(){r.getByteFrequencyData(i),v()};p()}},{}],9:[function(e,n,t){var o=e("../model/tweetModel"),r=e("../model/3dObjectFactory"),i=e("../util/delayCall"),a=e("../util/color");n.exports=function(e){function n(){var e=new THREE.RenderPass(c,u),n=new THREE.BokehPass(c,u,{focus:.8,aperture:.015,maxblur:1});n.renderToScreen=!0;var t=new THREE.WebGLRenderTarget(T,x,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),o=new THREE.EffectComposer(l,t);o.addPass(e),o.addPass(n),H.composer=o,H.bokeh=n}var t,s,u,c,l,d,w,f,p,E,h,g=450,v={value:16777215},m=[],T=window.innerWidth,x=window.innerHeight,y=new THREE.Clock,H={},M=!0,R={x:0,y:0},b=function(){C(),S()},C=function(){var e=document.querySelector("#webgl");u=new THREE.PerspectiveCamera(60,T/x,1,2e3),u.position.z=2e3,d=new THREE.Vector3,c=new THREE.Scene,c.fog=new THREE.FogExp2(3355443,.002);var o=new THREE.DirectionalLight(16777215,1);o.position.set(1,1,1),c.add(o);var r=new THREE.DirectionalLight(34248,1);r.position.set(-1,-1,-1),c.add(r);var i=new THREE.AmbientLight(16777215);i.position.set(-1,-1,-1),c.add(i);var a=new THREE.SpotLight(34248,1);a.position.set(-1,-1,-1),c.add(a),s=new THREE.Object3D,E=new THREE.Object3D,t=new THREE.Object3D,c.add(s),s.add(E),s.add(t),l=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),l.setPixelRatio(window.devicePixelRatio),l.setClearColor(c.fog.color,0),l.setSize(window.innerWidth,window.innerHeight),M&&n(),e.appendChild(l.domElement),window.addEventListener("resize",k,!1),k(),A()},S=function(){F(E),h&&(clearInterval(h),h=null),o.getTweets(function(e,n){if(e)throw e;return d.set(0,0,0),n.length?q(n):void alert("Oy homes! We got no tweets for ya!")})},O=function(e){if(!e)throw new Error("Missing len");console.log("generatePositions: "+e);var n=[],t=e,o=0,r=.3,i=0,a=function(){var e=new THREE.Vector3;return e.set(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1),e},s=function(e){for(var t=!1,o=0;o<n.length;o++){var i=e.distanceTo(n[o]);if(r>i){t=!0;break}}return t};do{var u=a();s(u)?i++:(n.push(u),o++)}while(t>o);return console.log("numReCalcs: "+i),n},q=function(n){var o=O(n.length);w&&w.dispose(),m=[],w=new THREE.Geometry;var a=0;_.each(n,function(e){var n=r.getSphere();n.position.set(o[a].x,o[a].y,o[a].z),n.position.normalize(),n.position.multiplyScalar(10*Math.random()+g),n.userData.tweet=e,m.push(n),w.vertices.push(n.position),E.add(n),a++});for(var s=0;s<w.vertices.length;s++){var u=w.vertices[s],c=w.vertices[s+1];c&&t.add(r.getCylinder(u,c))}f=0,p=null,e.start(),new i(function(){z(j)},3500),$(".loader").addClass("hidden")},z=function(e){var n=3.5;TweenMax.to(s.rotation,2*n,{y:720*(Math.PI/180),yoyo:!1,repeat:0,ease:Sine.easeInOut,onComplete:function(){e()}}),TweenMax.to(u.position,n,{z:800,yoyo:!0,repeat:1,ease:Sine.easeInOut})},j=function(){TweenMax.to(u.position,2,{z:1e3,ease:Cubic.easeInOut,onComplete:function(){I()}}),TweenMax.to(R,5,{x:25,yoyo:!0,repeat:-1,ease:Sine.easeInOut}),TweenMax.to(R,8,{y:25,yoyo:!0,repeat:-1,ease:Sine.easeInOut})},F=function(e){if(e)for(var n=e.children.length-1;n>=0;n--)e.remove(e.children[n])},I=function(){f==w.vertices.length&&(f=0),p=m[f++],TweenMax.to(v,3,{colorProps:{value:16738740},ease:Cubic.easeInOut,onUpdate:function(){p.material.color.setHex(a.rgbToHex(v.value))}}),TweenMax.to(d,2,{x:p.position.x,y:p.position.y,z:p.position.z,ease:Cubic.easeInOut}),TweenMax.to(u.position,2,{z:2e3,ease:Cubic.easeInOut}),TweenMax.to(u,2,{fov:1,delay:2,ease:Cubic.easeOut,onUpdate:P}),TweenMax.to(u.position,2,{delay:1,z:p.position.z,ease:Cubic.easeInOut,onComplete:function(){t.visible=!1,D(p.userData.tweet.text),h=setInterval(function(){clearInterval(h),h=null,TweenMax.to(v,3,{colorProps:{value:16777215},ease:Cubic.easeInOut,onUpdate:function(){p.material.color.setHex(a.rgbToHex(v.value))}}),t.visible=!0,TweenMax.to(u,2,{fov:60,delay:0,ease:Cubic.easeInOut,onUpdate:P,onComplete:function(){TweenMax.to(u.position,4,{delay:1.5,z:1e3,onComplete:function(){I()}})}})},3e3)}})},P=function(){u.updateProjectionMatrix()},D=function(e){console.log(e);var n=$(".tweet");n.typed({strings:[e],typeSpeed:2,loop:!1,contentType:"text",showCursor:!1,loopCount:!1,callback:function(){console.log("callback")},resetCallback:function(){console.log("resetCallback")}})},k=function(){T=window.innerWidth,x=window.innerHeight,u.aspect=T/x,u.updateProjectionMatrix(),l.setSize(T,x),M&&H.composer.setSize(T,x),L()},A=function(){requestAnimationFrame(A),L()},L=function(){u.lookAt(d),u.position.x=R.x,u.position.y=R.y,l.render(c,u),M&&H.composer.render(y.getDelta())};window.innerWidth||(window.innerWidth=parent.innerWidth,window.innerHeight=parent.innerHeight),b()}},{"../model/3dObjectFactory":2,"../model/tweetModel":3,"../util/color":4,"../util/delayCall":5}]},{},[1]);